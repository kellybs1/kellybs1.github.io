<!DOCTYPE html>
<html lang="en">
<!--Start header-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <title>Brendan Kelly</title>
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <link href='https://fonts.googleapis.com/css?family=Questrial' rel='stylesheet' type='text/css'>
</head>

<body onload="Snake();">

    <div id="topNavbar" class="navbar navbar-default navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle Navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="index.html">Brendan Kelly</a>
            </div>
            <div class="navbar-collapse collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li class="active"><a href="index.html">Home</a></li>
					<li><a href="portfolio.html">Portfolio</a></li>   
                    <li><a href="about.html">About</a></li>
                    <li><a href="contact.html">Contact</a></li>     					
                </ul>
            </div>
        </div>
    </div>

<!--End header-->
	
    <div align="center" id="indexContainer" class="container" style="padding-top:40px" >
			<div class="myTitle">
				<h1>
					Welcome
				</h1>
			</div>

		<div id="greeting">JavaScript Snake
		</div>
		<div id="instructions"> Use arrow keys to move
		  <br> Eat frogs to grow
		  <br> Don't bite yourself or go out of bounds
		  <br> Press R to restart
		</div>
					
		<canvas id="myCanvas" width="480" height="340" style="border:1px solid #000000;"></canvas>
		<script>
		  function Snake() {
			var scoreMain = 0;
			var scoreMove = 1;
			var scoreEat = 1000;
			var direction;
			var blockSize = 20;
			var timerTick = 100;
			var snakeTails = [];
			var c = document.getElementById("myCanvas");
			var board = c.getContext("2d");
			var centerWidth = c.width / 2;
			var centerHeight = c.height / 2;
			var snake = {xPos: centerWidth, yPos: centerWidth - blockSize, size: blockSize, colour: '#FF9933'}
			var frog = {xPos: 0, yPos: 0, size: blockSize, alive: false, colour: '#006600'}
			function clearScreen() {
			  board.clearRect(0, 0, c.width, c.height);
			}
			function drawBlock(xPos, yPos, fillColour) {
			  board.fillStyle = fillColour;
			  board.fillRect(xPos, yPos, blockSize, blockSize);
			  board.strokeRect(xPos, yPos, blockSize, blockSize);
			}

			// Returns a random integer between min (included) and max (included)
			function getRandomIntInclusive(min, max) {
			  return Math.floor(Math.random() * (max - min + 1)) + min;
			}
			
			//picks a new spot for frog if it is not already spawned
			function moveFrog() {
			  if (frog.alive == false) {
				do {
				  frog.xPos = getRandomIntInclusive(blockSize, c.width - (blockSize * 2));
				  frog.yPos = getRandomIntInclusive(blockSize, c.height - (blockSize * 2));
				  //while positions are multiples of blocksize and this position isn't inside snake
				} while ((blockSizeMultiple(frog.xPos, frog.yPos) == false) || (checkFrogSpawnClear(frog.xPos, frog.yPos) == false))
				  frog.alive = true;
			  }
			}
			
			//Checks that chosen spawn point isn't inside snake
			function checkFrogSpawnClear(xPos, yPos) {
			  var clear = true;
			  for (i = 0; i < snakeTails.length; i++) {
				if (xPos == snakeTails[i].xPos && yPos == snakeTails[i].yPos) {
				  clear = false;
				}
			  }
			  return clear;
			}
			
			//Checks that position values are multiples of blocksize
			function blockSizeMultiple(xPos, yPos) {
			  var isMultiple = true;
			  if (xPos % blockSize > 0 || xPos % blockSize < 0 || yPos % blockSize > 0 || yPos % blockSize < 0) {
				isMultiple = false;
			  }
			  return isMultiple;
			}
			
			//checks for snake going outside of bounds
			function checkWallCollision() {
			  if (snake.xPos < 0 || snake.xPos >= c.width || snake.yPos < 0 || snake.yPos >= c.height) {
				gameOver();
			  }
			}
			
			//check for snake colliding with food
			function checkFrogSnakeCollision() {
			  if (snake.xPos == frog.xPos && snake.yPos == frog.yPos) {
				frog.alive = false;
				scoreByEating();
				growSnake();
			  }
			}
			
			//adds current position to snake tail array
			function growSnake() {
			  snakeTails.push({
				xPos: snake.xPos,
				yPos: snake.yPos
			  });
			}
			
			//draws tails of snakes
			function drawSnakeTails() {
			  for (i = 1; i < snakeTails.length; i++) {
				drawBlock(snakeTails[i].xPos, snakeTails[i].yPos, snake.colour);
			  }
			}
			
			//moves each tail section into the position of the section ahead of it
			function followSnakeTails() {
			  for (i = snakeTails.length - 1; i >= 1; i--) {
				snakeTails[i].xPos = snakeTails[i - 1].xPos;
				snakeTails[i].yPos = snakeTails[i - 1].yPos;
			  }
			}
			
			//check for snake colliding with self
			function checkSnakeSelfCollision() {
			  //do not check for collision with 1st tail block, allows "turning around" with 2-block-only snake
			  for (i = 2; i < snakeTails.length; i++) {
				if (snake.xPos == snakeTails[i].xPos && snake.yPos == snakeTails[i].yPos) {
				  gameOver();
				}
			  }
			}
			
			//score by eating a frog
			function scoreByEating() {
			  scoreMain += scoreEat;
			}
			
			//score for each movement, a "lifetime" score
			function scoreByMoving() {
			  if (direction > 0) {
				scoreMain += scoreMove;
			  }
			}
			
			//updates score display
			function updateScore() {
			  document.getElementById("scoreOut").innerHTML = "Score: " + scoreMain;
			}
			
			//finished by failure
			function gameOver() {
			  direction = 0;
			  clearInterval(myTicker);
			  document.getElementById("status").innerHTML = "Game Over!";
			}
			
			//moves snake in direction of current key press, used in tandem with document.body.onkeydown event
			function moveSnake() {
			  switch (direction) {
				case 1:
				  snake.yPos -= blockSize;
				  break;

				case 2:
				  snake.xPos += blockSize;
				  break;

				case 3:
				  snake.yPos += blockSize;
				  break;

				case 4:
				  snake.xPos -= blockSize;
				  break;
			  }		  
			  //set first array item to new current position -> tails follow this point
			  setSnakeHeadPosition();
			  scoreByMoving();
			}
			
			//reset snake head position in array
			function setSnakeHeadPosition() {
			  snakeTails[0] = {
				xPos: snake.xPos,
				yPos: snake.yPos
			  };
			}
			
			//reloads page -> restarts game
			function reloadPage() {
				location.reload();
			}
			
			//translates arrow keys (38,39,40,41) to direction choices 
			//82 is R key for restarting game
			document.body.onkeydown = function(e) {
			  var event = window.event ? window.event : e;
			  switch (event.keyCode) {
				case 38:
				e.preventDefault();
				  direction = 1;
				  break;

				case 39:
				e.preventDefault();
				  direction = 2;
				  break;

				case 40:
				e.preventDefault();
				  direction = 3;
				  break;

				case 37:
				e.preventDefault();
				  direction = 4;
				  break;
				  
				case 82:
				e.preventDefault();
				  reloadPage();
				  break;
			  }
			}
			
			//main timer event to run functions each tick
			var myTicker = setInterval(tickEvents, timerTick);
			function tickEvents() {
			  clearScreen();
			  moveSnake();
			  drawBlock(snake.xPos, snake.yPos, snake.colour);
			  checkSnakeSelfCollision();
			  moveFrog();
			  drawBlock(frog.xPos, frog.yPos, frog.colour);
			  checkWallCollision();
			  checkFrogSnakeCollision();
			  drawSnakeTails();
			  followSnakeTails();
			  updateScore();
			}
		  }
		</script>
			
		<!--Sets up divs for score output and game over text-->
		<div id="scoreOut"> </div>
		<div id="status"> </div>
		
    </div>

	<!--Start footer-->
	
    <div class="navbar navbar-default navbar-fixed-bottom">
        <div class="container">
            <div class="text-center">
                <div class="row">
                    <div id="footerLeftCol" class="col-sm-4">
                        <div class="center-to-left ">
                            <a href="https://github.com/kellybs1">Github</a> | <a href="contact.html">Contact</a> | <a href="about.html">About</a>
                        </div>
                    </div>
                    <div class="col-sm-4">

                    </div>
                    <div id="footerRightCol" class="col-sm-4 ">
                        <span class="center-to-right">
							<a href="contact.html"><i class ="fa fa-facebook-square fa-2x"></i></a>
							<a href="contact.html"><i class ="fa fa-twitter fa-2x"></i></a>
							<a href="contact.html"><i class ="fa fa-linkedin-square fa-2x"></i></a>
						</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
	
	<!--End footer-->

</body>

</html>